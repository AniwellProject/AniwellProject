<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script src="https://cdn.tailwindcss.com"></script>
	<link rel="stylesheet" th:href="@{/resource/css/main.css}">
	<link rel="stylesheet" th:href="@{/resource/css/dog-toggle.css}" />
	<link rel="stylesheet" href="https://unpkg.com/aos@2.3.1/dist/aos.css">

	<title>MAIN</title>
</head>

<body class="bg-gradient-to-b from-[#E4F0B9] to-[#FCDCA9]">
	<div class="section section-top mx-auto z-0">
		<img class="logo mx-auto" src="https://imgur.com/rcOcaL6.png" alt="d">
		<div class="bg-logo">

			<div class="char">
				<img class="img_head sway-top" src="/img/logo_head.PNG" alt="dog_cat">
				<img class="img_body w-full mx-auto absolute" src="/img/logo-body.png" alt="dog_cat">
			</div>
			<svg class="b-logo mx-auto" id="e2OkVSxci3g1" xmlns="http://www.w3.org/2000/svg"
				xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1337 502" shape-rendering="geometricPrecision"
				text-rendering="geometricPrecision" project-id="31d6e7ba95dd486ba30209ab768a484d"
				export-id="bc73799278e5498dbb3ddc517e5f81cf" cached="false">

				<!-- ✅ 모든 경로(p1~p6)의 합집합 클리핑 -->
				<clipPath id="clip-all" clipPathUnits="userSpaceOnUse">
					<!-- p1은 안쪽 구멍이 있는 복합경로라 evenodd 유지 -->
					<use href="#p1" style="fill:#000; stroke:none; fill-rule:evenodd" />
					<!-- 나머지는 채우기만 있으면 됨 -->
					<use href="#p2" style="fill:#000; stroke:none" />
					<use href="#p3" style="fill:#000; stroke:none" />
					<use href="#p4" style="fill:#000; stroke:none" />
					<use href="#p5" style="fill:#000; stroke:none" />
					<use href="#p6" style="fill:#000; stroke:none" />
					<use href="#p7" style="fill:#000; stroke:none" />
				</clipPath>

				<defs>
					<!-- 물결 한 타일(상단이 파형, 아래는 면으로 닫음) -->
					<path id="waveTile" d="
					            M0,0
					            C 200,60  300,-60  300,0
					            S 600,60 700,0
					            S 900,-60 1000,0
					            S 1200,60 1300,0
					            L1300,600 L0,600 Z  
					            " />


					<!-- 물 그라디언트(원하면 단색 fill로 바꿔도 됨) -->
					<linearGradient id="waterGrad" x1="0" y1="0" x2="0" y2="1">
						<stop offset="0%" stop-color="#1C6D81" />
						<stop offset="70%" stop-color="#1C6D81" />
					</linearGradient>

					<filter id="grainFilter" x="0" y="0" width="100%" height="100%">
						<!-- 1) 노이즈 생성 -->
						<feTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="2" seed="7"
							stitchTiles="stitch" result="noise" />
						<!-- 2) 콘트라스트/명암 조정 (거칠기 강도) -->
						<feColorMatrix in="noise" type="matrix" values="
					        1 0 0 0  0
					        0 1 0 0  0
					        0 0 1 0  0
					        0 0 0 30 -15" result="grain" />
						<!-- 3) 원본 그래픽과 Multiply 블렌드 -->
						<feBlend mode="multiply" in="SourceGraphic" in2="grain" result="blended" />
						<feComposite in="blended" in2="SourceAlpha" operator="in" />
					</filter>
				</defs>
				<!-- ✅ 모든 path 내부에서만 파도 보이게 -->
				<g filter="url(#grainFilter)" clip-path="url(#clip-all)">
					<g id="waterRise">
						<g id="waterWave">
							<use href="#waveTile" x="0" y="0" fill="url(#waterGrad)" />
							<use href="#waveTile" x="1300" y="0" fill="url(#waterGrad)" />
						</g>
					</g>
				</g>

				<path id="p1" class="draw" pathLength="1" d="M130.665441,137.686097
			       c6.786016,4.943678,18.066728,54.312959,22.949932,83.736237
			       s1.240536,34.735032-3.721611,36.595837
			       -17.367516,7.443221-31.013421-1.860806
			       -8.683757-21.089127-9.924294-29.152616
			       s4.962148-33.494494,7.443221-46.520131
			       s9.924294-46.520131,14.266173-42.798521Z

			       M122.76621,19.584635
			       C87.641445,34.288025,70.499398,53.949857,54.992688,125.280726
			       s-34.183866,207.162736-36.824665,225.457203
			       -10.047785,80.382277-10.047785,95.910671
			       s1.826869,21.922438,10.047784,26.489613
			       s7.307479,6.394045,20.095569,7.30748
			       s25.576179,6.394045,37.450834,0
			       s15.528394-7.307481,21.009004-18.2687
			       s4.567175-20.09557,5.48061-27.403049
			       s2.740306-66.680753,9.13435-76.728537
			       s10.961219-13.701524,19.182134-13.701524
			       s18.268698,3.653741,23.749308,6.394045
			       s28.218952,83.101128,30.188634,89.5059
			       s4.595924,23.569829,19.040258,28.232107
			       s18.610566,6.298942,34.104572,0
			       s21.091433-12.503164,21.091433-28.616346
			       -8.087441-97.237016-11.028826-111.453711
			       -11.275311-68.632322-13.236234-75.495555
			       -20.484006-127.250692-24.156921-140.718048
			       -12.231282-41.941825-20.201034-56.930187
			       c-5.312501-9.990987-15.548782-22.614582-20.813186-26.322559
			       -6.022022-4.241604-22.388503-14.035154-46.492317-9.354894Z" fill="none" stroke="#3f5787" stroke-width="2.674"
					fill-rule="evenodd" />


				<path id="p2" class="draw" pathLength="1"
					d="M293.019949,43.556752c17.37056,2.481509,30.757847,23.855723,43.055521,51.715033c13.100098,29.677132,45.708562,146.389554,50.395247,145.217883s-10.334922-137.930239-.144452-180.050847C389.738602,46.334495,405.718327,37.06655,417.0826,37.71301s20.304989,2.793429,28.120111,28.120111c12.377217,40.111191,8.201698,282.372792,8.201698,282.372792s1.611654,82.802397-24.95153,94.351607c-10.189575,4.43025-23.868367,9.624343-37.342446-6.544552s-34.647631-85.84913-34.647631-85.84913-26.019009-92.176619-31.94224-92.176619-2.993836,135.826177-2.993836,135.826177s2.188471,54.661193-10.522532,63.135195c-18.940558,12.627039-37.881117-1.57838-40.380514-11.493958-13.157794-52.199442-15.034009-294.367679-14.060057-316.351262.610652-13.783358-1.784267-57.184363,5.023884-70.657567s21.364585-16.558005,31.432442-14.889052Z"
					transform="translate(.000005-.526124)" fill="none" stroke="#3f5787" stroke-width="2.674" />
				<path id="p3" class="draw" pathLength="1"
					d="M540.599725,20.548727c-8.354726-4.803968-30.492879-6.295732-44.439115,1.374581s-22.108787,21.667878-24.539088,33.863942.613733,20.014946,3.435472,32.882378c5.077711,23.154905,13.484773,232.288208,6.20546,272.641671s-13.928243,33.946705-17.7333,59.630832c-.898226,6.063024-4.548395,17.518243,3.81746,25.82399c18.945789,18.809665,93.749068,10.572109,106.439747-13.473386c8.533145-16.168063,7.716902-31.628241-2.702944-49.369874-5.339421-9.09131-7.509613-12.686721-12.720278-26.712584-17.432842-46.925037-16.18104-242.176343-11.631455-258.71154s8.174608-27.551458,10.006691-39.091122-3.188823-28.833216-16.13865-38.858888Z"
					transform="translate(0 0.000002)" fill="none" stroke="#3f5787" stroke-width="2.674" />
				<path id="p4" class="draw" pathLength="1"
					d="M594.232235,18.126068c-19.433383,8.502105-27.479087,15.944237-25.506315,55.870977s18.727414,198.288858,20.647969,202.835936s9.442212,132.769016,35.223007,157.896239c23.625339,23.02641,48.513349,1.268549,54.65639-8.502105s26.607925-93.417741,27.819037-93.417741s17.755451,86.982699,25.04297,99.378848s26.372231,28.649285,52.807015,3.755585s101.511147-360.444814,70.446014-389.882252c-21.879467-20.733066-42.578077.302673-48.583458,13.360451-9.517254,20.693807-39.845145,197.399752-47.98416,192.256537s-9.774951-66.756607-20.032682-86.587515-37.063977-19.318838-47.368871,2.429173-24.065946,88.636533-25.75298,89.851119-17.277056-184.588862-26.474238-207.666005-25.506316-40.081353-44.939698-31.579247Z"
					transform="translate(.000001 0.000001)" fill="none" stroke="#3f5787" stroke-width="2.674" />
				<path id="p5" class="draw" pathLength="1"
					d="M899.508664,47.777594c-13.60685,11.816172-60.735242,351.871388-60.735242,351.871388s-2.725833,28.159525,13.133557,43.861125s80.858992,10.271669,98.512905,1.82423s56.859557-33.789647,61.320011-61.296943-7.681892-32.709992-13.629163-35.93143c-14.737115-7.982603-34.971521-4.25151-51.434321-16.57318s-6.303771-37.943474,5.838574-42.403927c7.23363-2.657252,35.683628,1.239014,52.038624-4.95606s18.287424-25.025243,13.381361-37.418248-5.963536-14.825862-13.45048-19.318029-46.721686-8.59425-51.06983-14.946151s7.332743-55.784363,15.491296-64.297637s66.116396-.071646,80.341591-11.3205s14.225194-46.419054,5.240861-59.14686-76.366831-20.963444-96.581581-26.204305-44.921667-15.722584-58.398163-3.743473Z"
					transform="translate(.000003 0)" fill="none" stroke="#3f5787" stroke-width="2.674" />
				<path id="p6" class="draw" pathLength="1"
					d="M1118.001482,60.134033c-22.018523,5.751014-26.969159,12.884289-41.716714,100.607534s-45.922346,225.725355-47.808551,254.178582c-2.828953,42.674494,13.664578,54.181993,42.710287,54.358547s71.491922,1.847465,84.744059-15.617598s3.594868-49.036864-6.474704-59.994928c-5.520495-6.007598-28.038473-9.031427-36.003053-18.765913s22.123831-166.371214,31.858317-196.459625s17.157419-74.851034,14.159253-91.150187-19.174987-30.634832-41.468894-27.156412Z"
					fill="none" stroke="#3f5787" stroke-width="2.674" />
				<path id="p7" class="draw" pathLength="1"
					d="M1244.425888,66.051567c-22.123831,18.584019-46.212375,166.916756-58.406914,243.362149-12.140396,76.105981-15.037121,128.136731-9.763577,142.107384c8.198444,21.719288,53.899344,34.153166,83.723488,29.752549c10.876046-1.604784,42.311811-3.491611,49.106627-34.135094s-28.44101-42.33372-30.841357-42.818584c-1.85393-.634683-20.033002-6.290988-26.73864-23.225041s35.280263-209.301111,38.937943-225.663083s11.10573-63.05509,8.849533-74.336075c-3.539813-17.699065-32.743273-33.628224-54.867103-15.044205Z"
					transform="translate(.000001 0)" fill="none" stroke="#3f5787" stroke-width="2.674" />
			</svg>
			<div class="scroll-indicator absolute w-full mx-auto z-10 mt-52">
				<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 64 64"
					class="mx-auto animate-bounce-down">
					<circle cx="32" cy="32" r="30" stroke="#ffffffaa" stroke-width="2" fill="none" />
					<line x1="32" y1="20" x2="32" y2="40" stroke="#ffffff" stroke-width="3" stroke-linecap="round" />
					<polyline points="24,34 32,42 40,34" fill="none" stroke="#ffffff" stroke-width="3"
						stroke-linecap="round" stroke-linejoin="round" />
				</svg>
			</div>

			<div class="icon z-10">
				<!-- 로그인 버튼 -->
				<button type="button" class="" th:if="${!rq.isLogined}"
					onclick="setTimeout(() => { location.href='/usr/member/login'; }, 1000)">
					<div class="toggle dog-rollover">
						<input type="checkbox" id="doggo">
						<label for="doggo" class="toggle-item">
							<div class="dog">
								<div class="ear"></div>
								<div class="ear right"></div>
								<div class="face">
									<div class="eyes"></div>
									<div class="mouth"></div>
								</div>
							</div>
						</label>
					</div>
				</button>

				<div class="up-icon z-10">
					<button id="vetList" type="button" class="in-icon hidden">
						vetlist
						<img src="https://i.imgur.com/2ZJPrGR.png" alt="vetlist">
					</button>
					<button id="petlist" type="button" class="in-icon hidden">
						petlist
						<img src="https://i.imgur.com/2ZJPrGR.png" alt="petlist">
					</button>
				</div>
			</div>
		</div>

	</div>

	<!-- 중간 섹션 -->
	<div id="sectionMiddle" class="z-10 section-middle mx-auto transition-all duration-700">



		<!-- 🐾 세션 2 -->
		<section id="sec2"
			class="flex items-center min-h-[100dvh] md:min-h-screen w-full bg-gradient-to-b from-[#fff7e6] to-[#ffe4b3]">
			<!-- 🌊 파도 배경 -->
			<div class="wave"></div>
			<div class="mx-auto grid md:grid-cols-2 items-center gap-6 md:gap-10 px-6 md:px-16 py-32">
				<!-- 왼쪽: 문구 -->
				<div class="max-w-2xl" data-aos="fade-right">
					<h2 class="text-5xl font-extrabold text-[#2b2b2b] drop-shadow mb-4">
						우리 아이의 하루,<br>발자국까지 기록합니다 🐾
					</h2>
					<p class="text-lg text-gray-700 leading-relaxed">
						배변 횟수와 움직임을 분석해<br>어디에서 얼마나 머물렀는지 알려드려요.
					</p>
				</div>

				<!-- 오른쪽: 애니메이션 요소 -->
				<div class="relative h-[40vh] md:h-[60vh] overflow-visible">
					<!-- 원하는 이미지/SVG/Lottie로 교체 가능 -->
					<img src="/img/default-pet.png" alt="paw"
						class="right-anim absolute right-0 bottom-0 w-[55%] max-w-[420px]" />
				</div>
			</div>
		</section>

		<!-- 📸 세션 3 -->
		<!-- 섹션 3 : 핀 고정 애니메이션 -->
		<section id="sec3" class="min-h-[100dvh] md:min-h-screen w-full bg-gradient-to-b from-[#e0f7fa] to-[#b2ebf2]">
			<div class="mx-auto grid md:grid-cols-2 items-center gap-6 md:gap-10 px-6 md:px-16 py-16">
				<!-- 왼쪽: 문구 -->
				<div class="max-w-2xl">
					<h2 class="text-5xl font-extrabold text-cyan-900 drop-shadow mb-4">
						한 장의 사진으로 마음을 읽어요 💖
					</h2>
					<p class="text-lg text-gray-700 leading-relaxed">
						반려동물의 표정과 행동 패턴을 분석해<br>행복, 즐거움, 피곤함까지 알려드립니다.
					</p>
				</div>

				<!-- 오른쪽: 여러 레이어를 순차 애니메이션 -->
				<div class="relative h-[45vh] md:h-[65vh]">
					<img src="/img/emo-cat.png" class="sec3-layer absolute right-0 bottom-0 w-[70%] max-w-[480px]" />
					<img src="/img/emo-cat.png" class="sec3-dog absolute right-[10%] bottom-[8%] w-[42%] opacity-0" />
					<img src="/img/emo-cat.png" class="sec3-heart absolute right-[40%] top-[10%] w-[12%] opacity-0" />
					<img src="/img/emo-cat.png" class="sec3-sparkle absolute right-[22%] top-[4%] w-[10%] opacity-0" />
				</div>
			</div>
		</section>


	</div>



	<!-- AOS 라이브러리 불러오기-->
	<link rel="stylesheet" href="https://unpkg.com/aos@2.3.1/dist/aos.css">
	<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
	<script>
		AOS.init();
	</script>

	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script>
		if (![[${rq.isLogined}]]) {
			// 로그인 상태가 아니라면 localStorage 정리
			localStorage.removeItem("loginedMember");
			localStorage.removeItem("selectedPetId");
		}
	</script>
	<!-- JS -->
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/ScrollTrigger.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/ScrollToPlugin.min.js"></script>

	<script>
		document.addEventListener('DOMContentLoaded', () => {
			AOS.init({once: true, duration: 600, easing: 'ease-out'});
		});
	</script>
	<script>

		const isLogined = localStorage.getItem("loginedMember") !== null;

		if (!isLogined) {
			localStorage.removeItem("loginedMember");
			localStorage.removeItem("selectedPetId");
			return;
		}

		document.getElementById("loginButton").classList.add("hidden");
		if (!memberId) return;

		$.get("/api/member/getUsrInfo", {memberId})
			.done(function (data) {
				const authLevel = data.authLevel;
				if (authLevel === 3) {
					$("#vetList").removeClass("hidden").on("click", () => {
						location.href = "/usr/vetAnswer/vetList";
					});
				} else {
					$("#petlist").removeClass("hidden").on("click", () => {
						location.href = `/usr/pet/list?memberId=${memberId}`;
					});
				}
			})
			.fail((err) => console.error("getUsrInfo 실패", err));

		// 로그인 버튼 클릭 시
		document.getElementById("loginButton").addEventListener("click", () => {
			setTimeout(() => {
				location.href = "/usr/member/login";
			}, 1000);
		});
	</script>

	<script>
		gsap.registerPlugin(ScrollTrigger);

		// section-top의 하단이 뷰포트 하단에 닿는 지점부터 200px 스크롤 구간 동안
		// #sectionMiddle의 margin-top을 0 -> -80px로 보간
		gsap.to("#sectionMiddle", {
			marginTop: -80,
			ease: "none",
			scrollTrigger: {
				trigger: ".section-top",
				start: "bottom bottom", // section-top의 bottom이 뷰포트 bottom과 만날 때 시작
				end: "+=200",           // 200px 스크롤 동안 변화 (체감에 맞게 120~300 사이로 조절)
				scrub: true             // 스크롤 연동
				// markers: true         // 디버그용
			}
		});

		// 중간 섹션 안 요소들 페이드업(옵션)
		gsap.utils.toArray('#sectionMiddle .animate-content').forEach((el, i) => {
			gsap.fromTo(el,
				{opacity: 0, y: 24},
				{
					opacity: 1, y: 0, duration: 0.6, delay: i * 0.08,
					scrollTrigger: {trigger: el, start: "top 80%"}
				}
			);
		});
	</script>

	<script>


		// 오른쪽 패럴랙스 (세션2)
		gsap.fromTo(".right-anim",
			{y: 80, opacity: 0, rotate: -4, scale: 0.96},
			{
				y: -40, opacity: 1, rotate: 0, scale: 1,
				ease: "power2.out",
				scrollTrigger: {
					pinSpacing: true,
					trigger: "#sec2",             // ✅ 섹션 자체를 트리거
					start: "top bottom",          // 섹션 top이 뷰포트 bottom에 닿을 때 시작
					end: "bottom top",            // 섹션 bottom이 뷰포트 top에 닿을 때 끝
					scrub: true
				}
			}
		);


		const tl3 = gsap.timeline({
			scrollTrigger: {
				trigger: "#sec3",                // 세션 루트
				start: "top  top",                // 세션 시작과 동시에
				end: () => "+=" + window.innerHeight * 2, // 2뷰포트 길이 만큼 진행
				scrub: true,
				pin: true,             // ✅ 자식만 고정
				pinSpacing: true,               // ✅ pinSpacer 생성 안 함 (부모 레이아웃 안 흔들림)
				anticipatePin: 1,
				invalidateOnRefresh: true,
				markers: true,
				id: "sec3",
			}
		});
		tl3.fromTo(".sec3-layer",
			{y: 40, scale: 0.92, rotate: -2, opacity: 0},
			{y: 0, scale: 1, rotate: 0, opacity: 1, duration: 0.35, ease: "power2.out"}
		).to(".sec3-dog", {opacity: 1, y: -10, duration: 0.25, ease: "power2.out"}, ">-0.05")
			.to(".sec3-heart", {opacity: 1, y: -20, scale: 1.1, duration: 0.2, ease: "back.out(2)"}, "+=0.05")
			.to(".sec3-sparkle", {opacity: 1, y: -16, scale: 1.08, duration: 0.2, ease: "back.out(2)"}, "<0.05")
			.to([".sec3-layer", ".sec3-dog", ".sec3-heart", ".sec3-sparkle"],
				{y: -30, duration: 0.4, ease: "none"});

	</script>



	<script>

		let memberId = null;
		function ee() {
			$.ajax({
				type: "GET",
				url: `/api/member/myPage`,
				success: function (data) {
					console.log(data.id);
					memberId = data.id;
					localStorage.setItem("loginedMember", memberId);
					e();
				},
				error: function (err) {
					console.error("가져오기실패", err);
				}
			});
		}
		let authLevel = null;
		function e() {
			$.ajax({
				type: "GET",
				url: `/api/member/getUsrInfo`,
				data: {memberId: memberId},
				success: function (data) {
					authLevel = data.authLevel;
					if (authLevel === 3) {
						// 수의사 버튼만 보여주기
						$("#vetList").removeClass("hidden").on("click", function () {
							location.href = "/usr/vetAnswer/vetList";
						});
					} else {
						// 일반 사용자 버튼만 보여주기
						$("#petlist").removeClass("hidden").on("click", function () {
							location.href = `/usr/pet/list?memberId=${memberId}`;
						});
					}
				},
				error: function (err) {
					console.error("getUsrInfo 실패", err);
				}
			});
		}

		ee();
	</script>


</body>

</html>